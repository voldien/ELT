#include"wnd_snd.h"
#ifdef EX_WINDOWS
LPDIRECTSOUND8 pDS = EX_NULL;
	
DECLSPEC ERESULT ELTAPIENTRY ExInitDirectSound(ExWin hWnd, Uint32 flag){
	ERESULT hr;

	CoInitializeEx(EX_NULL,COINIT_MULTITHREADED);

	if(FAILED(hr = DirectSoundCreate8(EX_NULL, &pDS,EX_NULL))){
		ExDevPrintf("Failed to Create DirectSound %s", ExGetHResultErrorMessage(hr));
	}
	if(FAILED( hr = pDS->SetCooperativeLevel(hWnd, DSSCL_PRIORITY))){
		ExDevPrintf("Failed to Set Cooperative Level on DirectSound %s", ExGetHResultErrorMessage(hr));
	}

	return hr;
}


DECLSPEC Void ELTAPIENTRY ExReleaseDirectSound(Void){
	ERESULT hr;
	if(pDS)
		if(FAILED(hr = pDS->Release()))
			wExDevPrintf(EX_TEXT("Failed to Release DirectSound"), ExGetHResultErrorMessage(hr));
}
#endif